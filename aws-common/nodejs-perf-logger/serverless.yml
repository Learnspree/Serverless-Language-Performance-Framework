# This function is part of the AWS performance testing framework. It is triggered from cloud-watch
# logs of any specified target functions (via their cloud watch logs) under "events:" below.

service: nodejs-perf-logger

provider:
  name: aws
  runtime: nodejs6.10
  memorySize: 128
  timeout: 20
  region: us-east-1
  stage: dev
  versionFunctions: true # Optional function versioning
  # Import the API Url that was exported from the API serverless module (TODO - add ${self:provider:stage} to the export/import )
  environment:
    POST_METRICS_URL: 
      'Fn::ImportValue': 'SpfApiUrl'

  
# packaging information here
package:
  include:
    - node_modules/**

functions:
  logger-node:
    handler: handler.logger
    events:
      - cloudwatchLog:
          logGroup: '/aws/lambda/aws-empty-test-functions-dev-awsnode610'
          filter: 'REPORT'
      - cloudwatchLog:
          logGroup: '/aws/lambda/aws-empty-test-functions-dev-awsnode810'
          filter: 'REPORT'          
  logger-dotnet:
    handler: handler.logger
    events:
      - cloudwatchLog:
          logGroup: '/aws/lambda/aws-empty-test-functions-dev-dotnet2'
          filter: 'REPORT'
  logger-java:
    handler: handler.logger
    events:
      - cloudwatchLog:
          logGroup: '/aws/lambda/aws-empty-test-functions-dev-aws-empty-java8'
          filter: 'REPORT'
  logger-python:
    handler: handler.logger
    events:
      - cloudwatchLog:
          logGroup: '/aws/lambda/aws-empty-test-functions-dev-awspython3'
          filter: 'REPORT'
  logger-go:
    handler: handler.logger
    events:
      - cloudwatchLog:
          logGroup: '/aws/lambda/aws-empty-test-functions-dev-aws-empty-go'
          filter: 'REPORT'          


